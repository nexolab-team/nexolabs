<!--
┌── Message from havoc ────────────────────────────────────────────────────┐
│                                                                                │
│   Hello, me and my team have spent countless hours in designing this website   │
│   Please don't copy it, make something original from scratch                   │
│   It is not that hard really!!                                                 │
│                                                                                │
└────────────────────────────────────────────────────────────────────────────────┘
-->
---
const base = import.meta.env.BASE_URL || '';
---

<nav class="fixed top-0 w-full z-50 bg-black/80 backdrop-blur-md border-b border-cyan-500/30">
  <div class="container mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <a href={`${base}/`} class="text-2xl font-bold font-orbitron glitch-text">
        NEXOLABS
      </a>
      
      <!-- Desktop Menu -->
      <div class="hidden md:flex gap-8 items-center">
        <a href={`${base}/`} class="nav-link">Home</a>
        <a href={`${base}/about`} class="nav-link">About</a>
        <a href={`${base}/writeups`} class="nav-link">Writeups</a>
        <a href={`${base}/achievements`} class="nav-link">Achievements</a>
        <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
          <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg class="moon-icon hidden" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
      </div>
      
      <!-- Mobile Hamburger -->
      <button id="mobileMenuBtn" class="md:hidden hamburger" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu">
      <a href={`${base}/`} class="mobile-nav-link">Home</a>
      <a href={`${base}/about`} class="mobile-nav-link">About</a>
      <a href={`${base}/writeups`} class="mobile-nav-link">Writeups</a>
      <a href={`${base}/achievements`} class="mobile-nav-link">Achievements</a>
      <button id="themeToggleMobile" class="theme-toggle mobile">
        <span class="theme-label">Theme</span>
        <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="moon-icon hidden" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </div>
  </div>
</nav>

<!-- Back to Top Button -->
<button id="backToTop" class="back-to-top" aria-label="Back to top">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <polyline points="18 15 12 9 6 15"></polyline>
  </svg>
</button>

<style>
  .nav-link {
    @apply text-cyan-400 hover:text-magenta-400 transition-colors duration-300 font-mono;
    position: relative;
  }
  
  .nav-link::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 2px;
    background: linear-gradient(90deg, #00ffff, #ff00ff);
    transition: width 0.3s ease;
  }
  
  .nav-link:hover::after {
    width: 100%;
  }
  
  .glitch-text {
    @apply text-cyan-400;
    text-shadow: 
      0 0 10px #00ffff,
      0 0 20px #00ffff,
      0 0 30px #00ffff;
    animation: glitch 3s infinite;
  }
  
  @keyframes glitch {
    0%, 100% { text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff; }
    50% { text-shadow: 0 0 20px #ff00ff, 0 0 30px #ff00ff; }
  }
  
  /* Hamburger Menu - Only visible on mobile */
  .hamburger {
    @apply flex flex-col gap-1.5 p-2;
  }
  
  /* Hide hamburger on desktop (md: 768px and above) */
  @media (min-width: 768px) {
    .hamburger {
      display: none !important;
    }
  }
  
  .hamburger span {
    @apply block w-6 h-0.5 bg-cyan-400 transition-all duration-300;
  }
  
  .hamburger.active span:nth-child(1) {
    transform: translateY(8px) rotate(45deg);
  }
  
  .hamburger.active span:nth-child(2) {
    opacity: 0;
  }
  
  .hamburger.active span:nth-child(3) {
    transform: translateY(-8px) rotate(-45deg);
  }
  
  /* Mobile Menu - Only visible on mobile devices */
  .mobile-menu {
    @apply flex flex-col gap-4 mt-4 pb-4;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
    display: flex;
  }
  
  /* Hide mobile menu completely on desktop */
  @media (min-width: 768px) {
    .mobile-menu {
      display: none !important;
      max-height: 0 !important;
    }
  }
  
  .mobile-menu.active {
    max-height: 400px;
  }
  
  /* Ensure mobile menu only shows on mobile when active */
  @media (max-width: 767px) {
    .mobile-menu {
      display: flex;
    }
  }
  
  .mobile-nav-link {
    @apply text-cyan-400 hover:text-magenta-400 transition-colors duration-300 font-mono text-lg;
    @apply py-2 border-b border-cyan-500/20;
  }
  
  /* Theme Toggle */
  .theme-toggle {
    @apply p-2 rounded-lg border border-cyan-500/30 bg-black/30;
    @apply hover:border-magenta-400 hover:bg-magenta-400/10 transition-all duration-300;
    @apply text-cyan-400 hover:text-magenta-400;
  }
  
  .theme-toggle.mobile {
    @apply flex items-center gap-3 w-full justify-between;
  }
  
  .theme-label {
    @apply font-mono text-cyan-400;
  }
  
  /* Back to Top Button */
  .back-to-top {
    @apply fixed bottom-8 right-8 p-4 rounded-full;
    @apply bg-cyan-500/20 border-2 border-cyan-400 text-cyan-400;
    @apply hover:bg-cyan-400 hover:text-black transition-all duration-300;
    @apply opacity-0 pointer-events-none;
    z-index: 40;
    box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
  }
  
  .back-to-top.visible {
    @apply opacity-100 pointer-events-auto;
    animation: fadeInUp 0.3s ease-out;
  }
  
  .back-to-top:hover {
    transform: translateY(-4px);
    box-shadow: 0 0 30px rgba(0, 255, 255, 0.6);
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  // Mobile Menu Toggle - Only on mobile devices
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const mobileMenu = document.getElementById('mobileMenu');
  
  // Check if device is mobile
  function isMobileDevice() {
    return window.innerWidth < 768;
  }
  
  // Only enable mobile menu functionality on mobile devices
  if (isMobileDevice() && mobileMenuBtn && mobileMenu) {
    mobileMenuBtn.addEventListener('click', () => {
      mobileMenuBtn.classList.toggle('active');
      mobileMenu.classList.toggle('active');
    });
    
    // Close mobile menu when clicking nav links
    document.querySelectorAll('.mobile-nav-link').forEach(link => {
      link.addEventListener('click', () => {
        mobileMenuBtn.classList.remove('active');
        mobileMenu.classList.remove('active');
      });
    });
  }
  
  // Handle resize - close menu if switching to desktop
  window.addEventListener('resize', () => {
    if (!isMobileDevice() && mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.classList.remove('active');
      mobileMenu.classList.remove('active');
    }
  });
  
  // Theme Toggle
  const themeToggle = document.getElementById('themeToggle');
  const themeToggleMobile = document.getElementById('themeToggleMobile');
  const html = document.documentElement;
  
  // Check for saved theme or default to dark
  const currentTheme = localStorage.getItem('theme') || 'dark';
  html.setAttribute('data-theme', currentTheme);
  updateThemeIcons(currentTheme);
  
  function updateThemeIcons(theme: string) {
    document.querySelectorAll('.theme-toggle').forEach(toggle => {
      const sunIcon = toggle.querySelector('.sun-icon');
      const moonIcon = toggle.querySelector('.moon-icon');
      if (theme === 'light') {
        sunIcon?.classList.add('hidden');
        moonIcon?.classList.remove('hidden');
      } else {
        sunIcon?.classList.remove('hidden');
        moonIcon?.classList.add('hidden');
      }
    });
  }
  
  function toggleTheme() {
    const newTheme = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    html.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    updateThemeIcons(newTheme);
  }
  
  themeToggle?.addEventListener('click', toggleTheme);
  themeToggleMobile?.addEventListener('click', toggleTheme);
  
  // Back to Top Button
  const backToTop = document.getElementById('backToTop');
  
  window.addEventListener('scroll', () => {
    if (window.scrollY > 500) {
      backToTop?.classList.add('visible');
    } else {
      backToTop?.classList.remove('visible');
    }
  });
  
  backToTop?.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
  
  // Smooth Scroll for Anchor Links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (this: HTMLAnchorElement, e: Event) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href') || '');
      if (target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });
</script>
